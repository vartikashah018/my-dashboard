{"version":3,"file":"index.umd.js","sources":["../index.ts"],"sourcesContent":["import { StoreApi } from 'zustand';\r\nimport { devtools as Devtools } from 'zustand/middleware';\r\n\r\ninterface IPayload {\r\n  type: string;\r\n  [key: string]: unknown;\r\n}\r\n\r\nconst getCallerFunctionNameFromStack = () => {\r\n  const error = new Error();\r\n  const firefox = (error?.stack?.split('\\n')[2].match(/^.*(?=@)/) || [])[0];\r\n  const chrome = ((((error?.stack?.split('at ') || [])[3] || '').match(/(^|\\.| <| )(.*[^(<])( \\()/) || [])[2] || '').split('.').pop();\r\n  const safari = error?.stack?.split('\\n')[2];\r\n\r\n  return firefox || chrome || safari || '';\r\n};\r\n\r\nconst getAction = (payload: IPayload | string, nameCaller: string, devtoolsName?: string) => {\r\n  const isObject = typeof payload === 'object';\r\n  const name = isObject ? ('type' in payload ? payload.type : '') : payload;\r\n  const actionName = [devtoolsName, name || nameCaller].filter(Boolean).join('/');\r\n\r\n  return isObject ? { ...payload, type: actionName } : actionName;\r\n};\r\n\r\nexport const devtools: typeof Devtools = (initializer, devtoolsOptions) =>\r\n  Devtools((set, get, api) => {\r\n    type S = ReturnType<typeof initializer> & {\r\n      [store: string]: ReturnType<typeof initializer>;\r\n    };\r\n\r\n    (api.setState as StoreApi<S>['setState']) = (target, replace, ...arg) => {\r\n      const nameCaller = getCallerFunctionNameFromStack();\r\n      const action = getAction([...arg]?.[0], nameCaller, devtoolsOptions?.name);\r\n      (set as Function)(target, replace, action);\r\n    };\r\n\r\n    return initializer(api.setState as typeof set, get, api);\r\n  });\r\n\r\nexport type DevtoolsOptions = typeof Devtools;\r\n"],"names":["getCallerFunctionNameFromStack","error","firefox","_a","chrome","_b","safari","_c","getAction","payload","nameCaller","devtoolsName","isObject","name","actionName","devtools","initializer","devtoolsOptions","Devtools","set","get","api","target","replace","arg","action"],"mappings":"6SAQA,MAAMA,EAAiC,IAAM,WACrC,MAAAC,EAAQ,IAAI,MACZC,KAAWC,EAAAF,GAAA,YAAAA,EAAO,QAAP,YAAAE,EAAc,MAAM;AAAA,GAAM,GAAG,MAAM,cAAe,IAAI,CAAC,EAClEC,QAAaC,EAAAJ,GAAA,YAAAA,EAAO,QAAP,YAAAI,EAAc,MAAM,SAAU,CAAI,GAAA,CAAC,GAAK,IAAI,MAAM,2BAA2B,GAAK,CAAA,GAAI,CAAC,GAAK,IAAI,MAAM,GAAG,EAAE,MACxHC,GAASC,EAAAN,GAAA,YAAAA,EAAO,QAAP,YAAAM,EAAc,MAAM;AAAA,GAAM,GAElC,OAAAL,GAAWE,GAAUE,GAAU,EACxC,EAEME,EAAY,CAACC,EAA4BC,EAAoBC,IAA0B,CACrF,MAAAC,EAAW,OAAOH,GAAY,SAC9BI,EAAOD,EAAY,SAAUH,EAAUA,EAAQ,KAAO,GAAMA,EAC5DK,EAAa,CAACH,EAAcE,GAAQH,CAAU,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG,EAE9E,OAAOE,EAAW,CAAE,GAAGH,EAAS,KAAMK,CAAe,EAAAA,CACvD,EAEaC,EAA4B,CAACC,EAAaC,IACrDC,WAAS,CAACC,EAAKC,EAAKC,KAKjBA,EAAI,SAAuC,CAACC,EAAQC,KAAYC,IAAQ,CACvE,MAAMd,EAAaV,IACbyB,EAASjB,EAAU,CAAC,GAAGgB,CAAG,EAAI,CAAC,EAAGd,EAAYO,GAAA,YAAAA,EAAiB,IAAI,EACxEE,EAAiBG,EAAQC,EAASE,CAAM,CAAA,EAGpCT,EAAYK,EAAI,SAAwBD,EAAKC,CAAG,EACxD"}