{"version":3,"file":"index.es.js","sources":["../index.ts"],"sourcesContent":["import { StoreApi } from 'zustand';\r\nimport { devtools as Devtools } from 'zustand/middleware';\r\n\r\ninterface IPayload {\r\n  type: string;\r\n  [key: string]: unknown;\r\n}\r\n\r\nconst getCallerFunctionNameFromStack = () => {\r\n  const error = new Error();\r\n  const firefox = (error?.stack?.split('\\n')[2].match(/^.*(?=@)/) || [])[0];\r\n  const chrome = ((((error?.stack?.split('at ') || [])[3] || '').match(/(^|\\.| <| )(.*[^(<])( \\()/) || [])[2] || '').split('.').pop();\r\n  const safari = error?.stack?.split('\\n')[2];\r\n\r\n  return firefox || chrome || safari || '';\r\n};\r\n\r\nconst getAction = (payload: IPayload | string, nameCaller: string, devtoolsName?: string) => {\r\n  const isObject = typeof payload === 'object';\r\n  const name = isObject ? ('type' in payload ? payload.type : '') : payload;\r\n  const actionName = [devtoolsName, name || nameCaller].filter(Boolean).join('/');\r\n\r\n  return isObject ? { ...payload, type: actionName } : actionName;\r\n};\r\n\r\nexport const devtools: typeof Devtools = (initializer, devtoolsOptions) =>\r\n  Devtools((set, get, api) => {\r\n    type S = ReturnType<typeof initializer> & {\r\n      [store: string]: ReturnType<typeof initializer>;\r\n    };\r\n\r\n    (api.setState as StoreApi<S>['setState']) = (target, replace, ...arg) => {\r\n      const nameCaller = getCallerFunctionNameFromStack();\r\n      const action = getAction([...arg]?.[0], nameCaller, devtoolsOptions?.name);\r\n      (set as Function)(target, replace, action);\r\n    };\r\n\r\n    return initializer(api.setState as typeof set, get, api);\r\n  });\r\n\r\nexport type DevtoolsOptions = typeof Devtools;\r\n"],"names":["getCallerFunctionNameFromStack","error","firefox","_a","chrome","_b","safari","_c","getAction","payload","nameCaller","devtoolsName","isObject","name","actionName","devtools","initializer","devtoolsOptions","Devtools","set","get","api","target","replace","arg","action"],"mappings":";AAQA,MAAMA,IAAiC,MAAM;;AACrC,QAAAC,IAAQ,IAAI,SACZC,OAAWC,IAAAF,KAAA,gBAAAA,EAAO,UAAP,gBAAAE,EAAc,MAAM;AAAA,GAAM,GAAG,MAAM,gBAAe,IAAI,CAAC,GAClEC,UAAaC,IAAAJ,KAAA,gBAAAA,EAAO,UAAP,gBAAAI,EAAc,MAAM,WAAU,CAAI,GAAA,CAAC,KAAK,IAAI,MAAM,2BAA2B,KAAK,CAAA,GAAI,CAAC,KAAK,IAAI,MAAM,GAAG,EAAE,OACxHC,KAASC,IAAAN,KAAA,gBAAAA,EAAO,UAAP,gBAAAM,EAAc,MAAM;AAAA,GAAM;AAElC,SAAAL,KAAWE,KAAUE,KAAU;AACxC,GAEME,IAAY,CAACC,GAA4BC,GAAoBC,MAA0B;AACrF,QAAAC,IAAW,OAAOH,KAAY,UAC9BI,IAAOD,IAAY,UAAUH,IAAUA,EAAQ,OAAO,KAAMA,GAC5DK,IAAa,CAACH,GAAcE,KAAQH,CAAU,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG;AAE9E,SAAOE,IAAW,EAAE,GAAGH,GAAS,MAAMK,EAAe,IAAAA;AACvD,GAEaC,IAA4B,CAACC,GAAaC,MACrDC,EAAS,CAACC,GAAKC,GAAKC,OAKjBA,EAAI,WAAuC,CAACC,GAAQC,MAAYC,MAAQ;AACvE,QAAMd,IAAaV,KACbyB,IAASjB,EAAU,CAAC,GAAGgB,CAAG,EAAI,CAAC,GAAGd,GAAYO,KAAA,gBAAAA,EAAiB,IAAI;AACxE,EAAAE,EAAiBG,GAAQC,GAASE,CAAM;AAAA,GAGpCT,EAAYK,EAAI,UAAwBD,GAAKC,CAAG,EACxD;"}