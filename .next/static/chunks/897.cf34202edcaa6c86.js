"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[897],{2897:(e,l,t)=>{t.r(l),t.d(l,{default:()=>S});var r=t(7876),n=t(6520),o=t(7268),i=t(2643),s=t(4527),a=t(9224),c=t(8380),d=t(5657),u=t(7444),h=t(4293),x=t(2528),m=t(2781),p=t(3138),g=t(4027),f=t(6002),j=t(6796);t(1782);var b=t(4232);let v=[12.9716,77.5946],A=[{id:"open-meteo",name:"Open-Meteo"},{id:"mock-source",name:"Mock Source"}],C=e=>{let{drawing:l,setDrawing:t,currentPolygon:r,setCurrentPolygon:n}=e;return(0,p.Po)({click(e){l&&(r.length>=12||n(l=>[...l,[e.latlng.lat,e.latlng.lng]]))}}),null},k=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(let t of l)switch(t.operator){case">":if(e>t.value)return t.color;break;case">=":if(e>=t.value)return t.color;break;case"<":if(e<t.value)return t.color;break;case"<=":if(e<=t.value)return t.color;break;case"=":if(e===t.value)return t.color}return"#7c3aed"},S=e=>{var l;let{currentTemp:t}=e,[p,S]=(0,b.useState)(!1),[w,y]=(0,b.useState)([]),[P,z]=(0,b.useState)([]),[N,_]=(0,b.useState)(!1),[O,W]=(0,b.useState)(A[0].id),[D,R]=(0,b.useState)(null),[Z,E]=(0,b.useState)(0),F=[{operator:">=",value:25,color:"green"},{operator:"<",value:10,color:"red"},{operator:">=",value:10,color:"blue"}],M=e=>{z(l=>[...l,{id:Date.now().toString(),points:w,dataSource:e,field:"temperature_2m",rules:F,value:Number(t)}]),y([]),S(!1)};return(0,b.useEffect)(()=>{!t||isNaN(Number(t))||z(e=>e.map(e=>({...e,value:Number(t)})))},[t]),(0,r.jsxs)(n.A,{sx:{display:"flex",width:"100%",height:540,borderRadius:2,overflow:"hidden",boxShadow:3},children:[(0,r.jsxs)(n.A,{sx:{width:300,background:"#1f2333",color:"#fff",p:2},children:[(0,r.jsx)(o.A,{variant:"h6",sx:{mb:2},children:"Polygon Tools"}),(0,r.jsx)(i.A,{variant:"contained",fullWidth:!0,onClick:()=>{p?w.length<3||(A.length>1?_(!0):M(A[0].id)):(S(!0),y([]),R(null))},sx:{mb:2,bgcolor:p?"#7c3aed":"#23263a"},disabled:p&&w.length<3,children:p?"Finish Polygon":"Draw Polygon"}),p&&(0,r.jsxs)(o.A,{sx:{mb:2},children:["Points: ",w.length," (min 3, max 12)"]}),P.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.A,{variant:"subtitle1",sx:{mb:1},children:"Polygons"}),P.map(e=>(0,r.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"#2c3145",p:1,borderRadius:1,mb:1},children:[(0,r.jsxs)(o.A,{sx:{fontSize:13,cursor:"pointer"},onClick:()=>R(e.id),children:["#",e.id.slice(-4)," (",e.points.length," pts)"]}),(0,r.jsx)(s.A,{size:"small",onClick:()=>(e=>{z(l=>l.filter(l=>l.id!==e)),D===e&&R(null)})(e.id),children:(0,r.jsx)(m.A,{sx:{color:"#f87171",fontSize:18}})})]},e.id))]}),D&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.A,{variant:"subtitle1",sx:{mt:2},children:"Configure Rules"}),(0,r.jsx)(a.A,{fullWidth:!0,value:(null==(l=P.find(e=>e.id===D))?void 0:l.field)||"",onChange:e=>{let l=e.target.value;z(e=>e.map(e=>e.id===D?{...e,field:l}:e))},sx:{mt:1,mb:1},children:(0,r.jsx)(c.A,{value:"temperature_2m",children:"temperature_2m"})}),F.map((e,l)=>(0,r.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,r.jsxs)(o.A,{sx:{fontSize:13},children:[e.operator," ",e.value]}),(0,r.jsx)(n.A,{sx:{width:16,height:16,bgcolor:e.color,borderRadius:1}})]},l))]}),(0,r.jsxs)(o.A,{variant:"subtitle2",sx:{mt:2},children:["Selected Temperature: ",(0,r.jsxs)("strong",{children:[t,"\xb0C"]})]})]}),(0,r.jsx)(n.A,{sx:{flexGrow:1},children:(0,r.jsxs)(g.W,{center:v,zoom:15,style:{width:"100%",height:"100%"},scrollWheelZoom:!0,doubleClickZoom:!1,dragging:!0,zoomControl:!0,attributionControl:!1,minZoom:15,maxZoom:15,children:[(0,r.jsx)(f.e,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"\xa9 OpenStreetMap contributors"}),P.map(e=>(0,r.jsx)(j.t,{positions:e.points,pathOptions:{color:k(e.value,e.rules),fillColor:k(e.value,e.rules),fillOpacity:.4},eventHandlers:{click:()=>R(e.id)}},e.id)),p&&w.length>=3&&(0,r.jsx)(j.t,{positions:w,pathOptions:{color:"#7c3aed",fillColor:"#7c3aed",fillOpacity:.4}}),(0,r.jsx)(C,{drawing:p,setDrawing:S,currentPolygon:w,setCurrentPolygon:y})]},Z)}),(0,r.jsxs)(d.A,{open:N,onClose:()=>_(!1),children:[(0,r.jsx)(u.A,{children:"Select Data Source"}),(0,r.jsx)(h.A,{children:(0,r.jsx)(a.A,{value:O,onChange:e=>W(e.target.value),fullWidth:!0,children:A.map(e=>(0,r.jsx)(c.A,{value:e.id,children:e.name},e.id))})}),(0,r.jsxs)(x.A,{children:[(0,r.jsx)(i.A,{onClick:()=>_(!1),children:"Cancel"}),(0,r.jsx)(i.A,{onClick:()=>{M(O),_(!1)},variant:"contained",children:"Confirm"})]})]})]})}}}]);